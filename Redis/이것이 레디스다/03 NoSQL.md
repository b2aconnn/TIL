# 정의

마틴 파울러의 [NoSQL : 빅데이터 세상으로 떠나는 간결한 안내서] 에서는 NoSQL이 아래의 조건을 만족하는 데이터 저장소라고 기술되어 있다.

- 대용량 웹 서비스를 위하여 만들어진 데이터 저장소
- 관계형 데이터 모델을 지양하며 대량의 분산된 데이터를 저장하고 조회하는데 특화된 저장소
- 스키마 없이 사용 가능하거나 느슨한 스키마를 제공하는 저장소

💁‍♂️ **여기서는 'NoSQL이란 빅데이터를 처리하기 위한 분산 데이터 저장소의 통칭' 이라고 정의한다.**

<br>

**NoSQL의 일반적인 특징**

- NoSQL은 저마다 쓰기/읽기 성능 특화, 2차 인덱스 지원, 자동 샤딩 지원과 같은 고유한 특징을 가진다.

- 일반적으로 NoSQL은 관계형 데이터 베이스보다 쓰기와 읽기 성능이 월등히 빠르다.

<br>

# 탄생 배경

**글로벌 웹 서비스가 2000년대 중반부터 다수 등장하고, 글로벌 웹 서비스들은 기존의 관계형 데이터 베이스로 처리할 수 없을 정도로 데이터가 방대해졌다.**

- 대부분의 관계형 데이터 베이스에서 채택하고 있는 인덱스 처리 방법인 B-트리의 한계로 인해 데이터가 방대해질수록 읽기/쓰기 성능이 저하된다.
- 관계형 데이터 베이스는 중앙 집중식 데이터 관리 패턴에 해당하기 때문에 단일 하드웨어 성능에 따라 전체 시스템의 성능이 결정된다.

<br>

**구글, 아마존 등에서 논문과 자료를 통해 데이터를 실시간으로 분산 처리하는 개념을 공개하므로써, 이 개념을 토대로 실시간 분산 처리를 위한 오픈 소스 솔루션들이 개발이 되었고 이와 같은 노력의 결과물이 NoSQL이다.**

<br>

👉 **NoSQL 분산 환경에서 대량의 데이터를 빠르게 처리하기 위해 한두 가지 단점을 가진채로 개발이 되었다.**

- 관계형 데이터 베이스가 제공하는 쿼리와 트랜잭션 같은 편의 기능을 제공하지 않으며, 제공하는 데이터의 일관성 레벨도 NoSQL마다 다르다.
- 솔루션을 도입하기 위해선 해당 NoSQL의 설계 사상과 내부 구조를 파악해야 한다.

<br>

👉 **NoSQL 탄생과 더불어 일각에서는 전통적인 데이터 베이스 중심의 어플리케이션 개발에서 서비스 중심의 어플리케이션 개발이라는 패러다임의 전환이 일어났다.**

- 이러한 패러다임 전환은 데이터 베이스를 서비스 제공의 도구로 바라보게 되는 계기가 되었다.

<br>

👉 **NoSQL은 대량의 데이터를 빠르게 처리하기 위해서 다양한 방법을 사용한다.**

- 메모리에 데이터를 임시 저장하고 응답
- 동적인 스케일 아웃 지원
- 가용성을 위한 데이터 복제
- 스키마 없이 데이터 저장/조회가 가능해 실시간으로 시스템의 확장과 축소를 지원
- 시스템 정지 없이 저장소 소프트웨어 업그레이드 가능

<br>

# CAP 정리

**CAP 정리란, 이론 컴퓨터 과학 분야에서 분산 컴퓨터 시스템을 설명하는데 사용되는 이론이다.**

- '일관성, 가용성, 분할 허용성 모두를 동시에 지원하는 분산 컴퓨터 시스템은 없다'라고 정의되어 있다.
- NoSQL은 일관성, 가용성, 분할 허용성 가운데 두 가지 속성만을 지원하며 나머지 한 속성은 특정 조건에서만 만족한다.

CAP 정리를 이해하기 위해선 분산 시스템의 용어에 대한 이해가 우선되어야 한다.

<br>

## 분산 시스템

### **분산 시스템을 구성하는 개별 요소**

- 노드 : 분산 시스템을 구성하는 각각의 하드웨어 또는 소프트웨어
- 클러스터 : 동일한 기능을 수행하는 노드들의 모임

<img width="450" src="https://github.com/b2aconnn/TIL/assets/101120568/dc198a3a-bb42-44e6-a2df-7a8ec145e072"/>

<br>

### **일관성**

동시성 또는 동일성이라고도 하며 '다중 클라이언트에서 같은 시간에 조회하는 데이터는 항상 동일한 데이터임을 보증하는 것'을 의미

- 관계형 데이터 베이스에서는 기본적으로 일관성을 지원

- NoSQL에서는 빠른 분산 처리를 위해 일관성을 희생하기도 한다.

<br>

**가용성과 분할 허용성을 지원하는 NoSQL의 느슨한 일관성 예시**

<img width="500" src="https://github.com/b2aconnn/TIL/assets/101120568/0dd429c1-d9df-43c9-b518-33febe272644"/>

1. 클라이언트1이 노드 A에 접속하여 key1에 300이라는 값을 저장

2. 노드 A에서 '데이터 변경 전파' 이벤트가 발생
3. 데이터 변경 전파 이벤트에 의해 노드 B에 key1과 값 300이 복제
4. 클라이언트1이 노드 A에 저장된 key1의 값을 500으로 변경
5. 클라이언트2가 노드 B에 접속해 key1의 값을 조회
   - 노드 B에는 아직 key1:500 값이 변경되지 않았기 때문에 결과가 300으로 조회

> '데이터 변경 전파 이벤트' 는 NoSQL의 용어가 아니라 임의로 사용한 용어이다.

<br>

 👉 **위와 같은 방법을 사용하여 일관성 유지하는 것을 최종 일관성 또는 궁극적인 일관성이라고 한다.**

